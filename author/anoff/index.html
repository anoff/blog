<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Andreas Offenhaeuser"><meta name=description content="Andreas' personal blog"><meta name=keywords content=blog,personal,software,architecture,node,markdown,plantuml,developer><meta name=generator content="Hugo 0.55.6"><title>anoff | Andreas&#39; Blog</title><meta name=description content="anoff - Andreas' personal blog"><meta itemprop=name content=anoff><meta itemprop=description content="anoff - Andreas' personal blog"><meta property=og:title content=anoff><meta property=og:description content="anoff - Andreas' personal blog"><meta property=og:image content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200"><meta property=og:url content=https://blog.anoff.io/author/anoff/><meta property=og:site_name content="Andreas' Blog"><meta property=og:type content=website><link rel=icon type=image/png href=https://blog.anoff.io/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://blog.anoff.io/favicon-16x16.png sizes=16x16><link href=/author/anoff/ rel=alternate type=application/rss+xml title="Andreas' Blog"><link href=/author/anoff/ rel=feed type=application/rss+xml title="Andreas' Blog"><link rel=stylesheet href=/sass/combined.min.52f29c7c50b8b42d07e557633ac1b4544e3f91c2f3a5bb0ab34dcd0e14b4e38e.css><link rel=stylesheet href=https://blog.anoff.io/adoc.css><link rel=stylesheet href=https://blog.anoff.io/overwrites.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css></head><body class=bilberry-hugo-theme><nav class=permanentTopNav><div class=container><ul class=topnav><li><a href=//anoff.io/ target=_self>About me</a></li><li><a href=/ target=_self>Blog</a></li><li><a href=//anoff.io/project/ target=_self>Projects</a></li><li><a href=/tags target=_self>by Tags</a></li><li><a href=//radar.anoff.io target=_blank>Tech skills</a></li><li><a href=//anoff.github.io/legal/ target=_blank>Legal</a></li></ul></div></nav><header><div class=container><div class=logo><a href=/ class=logo><img src=/avatar.png alt>
<span class=overlay><i class="fa fa-child"></i></span></a></div><div class=titles><h3 class=title><a href=/>Andreas&#39; Blog</a></h3><span class=subtitle>Adventures of a software engineer/architect</span></div><div class="toggler permanentTopNav"><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-07-20-git-config-rebase-github-issue/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=content><h3><a href=https://blog.anoff.io/2019-07-20-git-config-rebase-github-issue/>Reference GitHub #issues during git rebase</a></h3><div class=meta><span class="date moment">2019-07-20</span>
<span class=readingTime>2 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>Being a developer most times means working with git.
There are many different ways to use git and every project, every developer has their preferences.
For my own projects I work a lot with GitHub and I love using the <code>git rebase -i</code> feature to clean up commits.</p><p>Lately I ran into the problem that rebasing a <a href=http://commitizen.github.io/cz-cli/>Commitizen</a> commit message with a linked GitHub issue leads to problems.
The problem is that the rebase UI treats the <code>&#35;</code> hash sign as an escape character for comments.
In the message below the reference to the GitHub issue &#35;53 would be removed from the commit message as <code>&#35;</code> is the leading character in line 3.</p><figure class=image-block><img src=/assets/git-rebase/reword-hash.png alt=Screenshot><figcaption>Figure 1. Rewording a commitizen message with GitHub issue &#35;id</figcaption></figure><p>This could be fixed by prepending some text to make sure the line does not start with a hash.</p><figure class=image-block><img src=/assets/git-rebase/reword-hash-leading.png alt=Screenshot><figcaption>Figure 2. Additional text to make sure the line does not start with &#35;</figcaption></figure><p>However the Commitizen style I use creates commit messages that include the issue ID on a new line and I did not want to break this pattern during rebases.
But luckily you can configure the escape character that git uses in the rebase UI.
By setting the <code>core.commentChar = ";"</code> (or any other <strong>single</strong> character) in your git config.</p><p>On my MacOS device my <code>~/.gitconfig</code> has the following entries after including the <code>commentChar</code> property.</p><figure class=listing-block><figcaption>$HOME/.gitconfig</figcaption><pre class=highlight><code>[user]
  ..
[core]
	editor = code --wait
	commentChar = ";"
[push]
	default = simple
[alias]
	lg = log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit
[credential]
	helper = osxkeychain
[gui]
	editor = nano</code></pre></figure><p>The next time you <code>git rebase -i</code> you will see that all comments are escaped using <code>;</code> instead of the hash sign.
This also means that my original commit message with a <code>&#35;</code> leading in line 3 will now be taken over as it is no longer treated as a comment.</p><figure class=image-block><img src=/assets/git-rebase/reword-semicolon.png alt=Screenshot><figcaption>Figure 3. Rewording a commit message after setting <code>core.commentChar</code></figcaption></figure><p>You can pick any character you want to escape comments in the rebase UI, just make sure it fits your workflow and does not conflict with any rules you have for git messages.</p><p>Hope this little trick can help you too 👋</p></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/github>github</a>
<a href=/tags/development>development</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-05-14-antora-navigation-files/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-05-14-antora-navigation-files/><img src=/assets/antora-arc42/title-3.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-05-14-antora-navigation-files/>Composing navigation files in Antora using the include macro</a></h3><div class=meta><span class="date moment">2019-05-14</span>
<span class=readingTime>4 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>This third post in the series of Antora posts quickly addresses a feature I only recently discovered.
It will show you some techniques you can use to compose the navigation menu in a multi-repository, multi-module setup.
This is especially interesting if you have content spread across repositories that you want to present hierarchically in the navigation tree.</p><p></p><section class="doc-section level-1"><h2 id=_using_multiple_navigation_files>Using multiple navigation files</h2><p>Let us start with the basics: <strong>How to combine navigation files?</strong></p><p>The <a href=https://docs.antora.org/antora/2.0/navigation/register-navigation-files/>Antora docs</a> explain how you can use multiple navigation files for one component by using the <code>nav</code> key in the component descriptor.
However this limits you to the operation of <strong>concatenation</strong>.</p><figure class=image-block><img src=/assets/antora-arc42/nav-concat.png alt="Concatenated navigation content"><figcaption>Figure 1. Concatenating navigation files via component descriptor</figcaption></figure><p>To achieve such concatenation just define your component as</p><figure class=listing-block><figcaption>antora.yml</figcaption><pre class=highlight><code class=language-yaml data-lang=yaml>name: bp
title: Bird Person
version: HEAD
nav:
- modules/ROOT/nav1.adoc
- modules/wedding/nav2.adoc
- modules/friends/nav3.adoc</code></pre></figure></section><section class="doc-section level-1"><h2 id=_composing_navigation_files_by_include>Composing navigation files by include</h2><p>In case a plain concatenation does not do it and you want to compose your navigation structure across three different navigation files you can use the <code>include:</code> macro.
This can come in handy if you split content into multiple modules and want to include the content of the modules in varying order in the navigation menu.</p><figure class=image-block><img src=/assets/antora-arc42/nav-inline.png alt="Inlined navigation content"><figcaption>Figure 2. Inlining navigation content</figcaption></figure><p>In this scenario the component descriptor would reference a single navigation file</p><figure class=listing-block><figcaption>antora.yml</figcaption><pre class=highlight><code class=language-yaml data-lang=yaml>name: bp
title: Bird Person
version: HEAD
nav:
- modules/ROOT/nav1.adoc</code></pre></figure><p>But the navigation file in turn references content from additional supplemental navigation files.</p><figure class=listing-block><figcaption>modules/ROOT/nav1.adoc</figcaption><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>.Bird Person
* xref:welcome.adoc[Welcome to Birdperson's life]
include::wedding:partial$nav2.adoc[
* xref:contact.adoc[Contact me]
link:friends:partial$nav3.adoc[]</code></pre></figure><figure class=listing-block><figcaption>modules/wedding/nav2.adoc</figcaption><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>* xref:wedding:invitation.adoc[Wedding Invitation]
** xref:wedding:attendees.adoc[Attendees]</code></pre></figure><figure class=listing-block><figcaption>modules/friends/nav3.adoc</figcaption><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>* Friends of Birdperson
** xref:friends:tammy.adoc[&lt;3 Tammy]
** xref:friends:morty.adoc[Morty]
** xref:friends:rick.adoc[Rick]</code></pre></figure><figure class=image-block><img src=/assets/antora-arc42/filetree-wedding.png alt="Screenshot of the file structure"><figcaption>Figure 3. File structure for included nav files</figcaption></figure><p>Given the above navigation files and directory structure you end up with the following navigation tree.
Notice how <code>nav2.adoc</code> is embedded in the content defined in <code>nav1.adoc</code>.</p><section class=ulist><h6 class=block-title>Bird Person</h6><ul><li>Welcome to Birdperson&#8217;s life</li><li>Wedding Invitation<ul><li>Attendees</li></ul></li><li>Contact me</li><li>Friends of Birdperson<ul><li>&lt;3 Tammy</li><li>Morty</li><li>Rick</li></ul></li></ul></section><section class="admonition-block important" role=doc-notice><h6 class="block-title label-only"><span class=title-label>Important:</span></h6><p>For navigation files to be used by <code>include:</code> in Antora you need to place them inside a folder that is indexed by Antora. The suggested solution is storing it as a partial so it does not clutter the actual page space.</p></section></section><section class="doc-section level-1"><h2 id=_nesting_navigation_listings_across_files>Nesting navigation listings across files</h2><p>There is another interesting scenario of including remote content.
Given our simple example this might seem far-fetched but consider the option of defining a high level list structure in <code>nav1.adoc</code> and filling certain branches of this navigation tree with included files.
In this scenario we want to include the list of Birdperson&#8217;s friends but <strong>continue the list indentation</strong> from <code>nav1.adoc</code>.</p><figure class=image-block><img src=/assets/antora-arc42/nav-nest.png alt="Nested navigation content"><figcaption>Figure 4. Nesting navigation content</figcaption></figure><p>By extending Birdpersons relationships also to enemies we want the following nav tree to be rendered:</p><section class=ulist><h6 class=block-title>Bird Person</h6><ul><li>Welcome to Birdperson&#8217;s life</li><li>Wedding Invitation<ul><li>Attendees</li></ul></li><li>Relationships<ul><li>Enemies<ul><li>Galactic Federation</li></ul></li><li>Friends<ul><li>&lt;3 Tammy</li><li>Morty</li><li>Rick</li></ul></li></ul></li><li>Contact me</li></ul></section><p>For the sake of simplicity we will not add any pages for the <em>Enemies / Galactic Federation</em> entries.
The changed files for this scenario are <code>nav1</code> and <code>nav3</code>.</p><figure class=listing-block><figcaption>modules/ROOT/nav1.adoc</figcaption><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>.Bird Person
* xref:welcome.adoc[Welcome to Birdperson's life]
link:wedding:partial$nav2.adoc[]
* Relationships
** Enemies
*** Galactic Federation
** Friends
+
--
link:friends:partial$nav3.adoc[]
--
+
* xref:contact.adoc[Contact me]</code></pre></figure><figure class=listing-block><figcaption>modules/friends/nav3.adoc</figcaption><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>** xref:friends:tammy.adoc[&lt;3 Tammy]
** xref:friends:morty.adoc[Morty]
** xref:friends:rick.adoc[Rick]</code></pre></figure><p>Notice how <code>nav3.adoc</code> in this case only hosts the sub-elements and not the <em>Friends</em> caption itself.
Using the same directory structure as previously the final rendered result in Antora looks like the nested list we expected to get.</p><figure class=image-block><img src=/assets/antora-arc42/navtree-wedding.png alt="Nested navigation tree"><figcaption>Figure 5. Nested navigation tree in Antora</figcaption></figure><p>As expected the content of <code>nav2.adoc</code> is included on the same list level as <code>nav1.adoc</code>.
The list of friends from <code>nav3.adoc</code> however continues as a nested indentation within <code>ROOT/nav1.adoc</code>.
The picture below shows the included sections highlighted according to their respective navigation files.</p><figure class=image-block><img src=/assets/antora-arc42/navtree-wedding-colored.png alt="Nested navigation tree (highlighted)"><figcaption>Figure 6. Nested navigation tree in Antora (highlighted)</figcaption></figure></section><section class="doc-section level-1"><h2 id=_closing_words>Closing words</h2><p>Dan Allen posted a fantastic answer to my <a href=https://gitlab.com/antora/antora/issues/423#note_166845701>initial question</a> regarding this issue.
I encourage you to read it if you have questions about what happens exactly.</p><p>Another neat trick is to <strong>reuse component definitions</strong> if you are forced to spread documentation across different repositories that you actually want to show up in a common navigation tree.
This might be the case for multi-repository software projects where you want to create one generic software documentation and aggregate by content (e.g. all interfaces in one place).
To achieve this just use the same <code>antora.yml</code> file (same <code>name:</code> and <code>version:</code>) in multiple repositories.</p><p>You can view the example directories in <a href=https://github.com/anoff/blog/tree/master/static/assets/antora-arc42/>github.com/anoff/blog</a> and run the <code>playbook-nest.yml</code>.</p><p>If you have any questions or know additional tricks let me know via <a href=https://twitter.com/anoff_io>Twitter</a> or leave a comment 👋</p></section></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/docs>docs</a>
<a href=/tags/architecture>architecture</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-05-08-asciidoc-plantuml-vscode/><i class="fa fa-fw fa-pencil"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-05-08-asciidoc-plantuml-vscode/><img src=/assets/asciidoc-plantuml/title.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-05-08-asciidoc-plantuml-vscode/>Preview AsciiDoc with PlantUML in VS Code</a></h3><div class=meta><span class="date moment">2019-05-08</span>
<span class=readingTime>4 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>This post is for everyone that likes to write AsciiDoc in VS Code but also wants to inline PlantUML diagrams within their docs.
In a previous post about <a href=/2018-07-31-diagrams-with-plantuml/>diagrams with PlantUML</a> I gave an intro into PlantUML and how to preview images in VS Code.
With the latest release of the asciidoctor plugin for VS Code it is possible to easily preview embedded PlantUML images within AsciiDocs.
No more need to maintain attributes in each file 🎉</p><p>Follow me on Twitter at <a href=https://twitter.com/anoff_io>@anoff_io</a> for future blog updates.
Currently I am writing mostly about <em>docs-as-code</em>.
Check <a href=/tags>my post tags</a> for other topics.</p><section class="doc-section level-1"><h2 id=_prerequisites>Prerequisites</h2><p>You should already have <a href=https://code.visualstudio.com/docs/setup/setup-overview>Visual Studio Code installed</a> on your machine.
At the time of writing this post I am using <code>v1.33.1</code> on MacOS and also verified the setup on a Windows 10 machine.</p><p>For the AsciiDoc preview to work we will use the <a href="https://marketplace.visualstudio.com/items?itemName=joaompinto.asciidoctor-vscode">AsciiDoc extension</a> that you can get by executing</p><div class=listing-block><pre class=highlight><code class=language-bash data-lang=bash>code --install-extension joaompinto.asciidoctor-vscode</code></pre></div><aside class="admonition-block note" role=note><h6 class="block-title label-only"><span class=title-label>Note:</span></h6><p>The feature we are going to use here is <a href=https://github.com/asciidoctor/asciidoctor-vscode/issues/155#event-2305465063>rather new</a> and shipped with <code>2.6.0</code> of the AsciiDoc plugin.</p></aside><p>The third thing you need is a PlantUML server.
There are multiple options:</p><div class="olist arabic"><ol class=arabic><li>use the public <a href=http://plantuml.com/plantuml>plantuml.com/plantuml</a> server</li><li>deploy your own <a href=https://github.com/plantuml/plantuml-server>plantuml-server</a></li><li>run <a href=https://hub.docker.com/r/plantuml/plantuml-server/>plantuml/plantuml-server</a> docker container on your local machine</li></ol></div><p>For test cases option 1 works fine; even if the server claims it does not store any data I would advise you to host your own server if you are working on anything professionally that is not open source.
Setting up a PlantUML server is rather easy if you are familiar with Docker, you can see an example setup in <a href=/2019-03-24-self-hosted-gitea-drone/>my blog post from march 2019</a>.
Finally the third option of running it locally within docker is great if you are on the road or sitting somewhere without WiFi.</p><aside class="admonition-block tip" role=doc-tip><h6 class="block-title label-only"><span class=title-label>Tip:</span></h6><p>Keep a list of docker images you always have pulled on <code>:latest</code> before going for trips.</p></aside><p>This post will use option 1 as it just works out of the box while following these instructions.</p></section><section class="doc-section level-1"><h2 id=_configuring_the_extension>Configuring the extension</h2><p>The <a href=https://github.com/asciidoctor/asciidoctor-vscode#options>option</a> we will use for this feature is <code>asciidoc.preview.attributes</code> that allows you to set arbitrary AsciiDoc attributes.
These attributes will be injected into the preview.
You could also set the attribute manually on each file but that is really something you do not want to do for generic configs like a server URL.
Build systems in the AsciiDoc ecosystem like <a href=//antora.org>Antora</a> allow you to set attributes during the build process (see <a href=https://github.com/anoff/antora-arc42/blob/master/playbook-remote.yml#L21>this example</a>), so having a local editor that also injects these attributes is super handy.</p><p>Under the hood the AsciiDoc VS Code extension relies on the <a href=https://github.com/asciidoctor/asciidoctor.js>javascript port of asciidoctor</a> and the <a href=https://github.com/eshepelyuk/asciidoctor-plantuml.js>asciidoctor-plantuml.js</a> extension.
This extension needs the <code>:plantuml-server-url:</code> attribute to be set in the AsciiDoc document to become active and parse PlantUML blocks.</p><p>So all you need to do in VS Code is to hop into your user settings and add the following entry</p><div class=listing-block><pre class=highlight><code class=language-javascript data-lang=javascript>"asciidoc.preview.attributes": {
  "plantuml-server-url": "http://plantuml.com/plantuml"
}</code></pre></div><section class="admonition-block warning" role=doc-notice><h6 class="block-title label-only"><span class=title-label>Warning:</span></h6><p>The downside of using the public server is that it does not offer SSL encrypted endpoints and you must weaken your VS Code security settings to preview correctly.</p></section><p>The PlantUML images are served over <code>http://</code> and you must allow your preview to include data from <em>unsafe</em> sources.
To do this open your command palette (⌘+P, ctrl+P) and enter <code>asciidoc preview security</code> and choose <em>Allow insecure content</em>.
In case you are running a local PlantUML server you may choose <em>Allow insecure local content</em>.</p><figure class=image-block><img src=/assets/asciidoc-plantuml/cmd1.png alt="command palette screenshot"><figcaption>Figure 1. opening asciidoc preview security settings</figcaption></figure><figure class=image-block><img src=/assets/asciidoc-plantuml/cmd2.png alt="command palette screenshot"><figcaption>Figure 2. allow insecure content</figcaption></figure></section><section class="doc-section level-1"><h2 id=_live_preview_asciidoc_with_embedded_plantuml>Live Preview AsciiDoc with embedded PlantUML</h2><p>To test it out just create an example file with some PlantUML content.</p><figure class=image-block><img src=/assets/asciidoc-plantuml/puml.svg alt=puml width=288 height=207><figcaption>Figure 3. This image is rendered on the fly</figcaption></figure><p>With the attribute set correctly the above code block renders as an image</p><div class=image-block><img src=/assets/asciidoc-plantuml/preview-ok.png alt="working preview"></div><div class=literal-block><pre>..without the attribute set or issues with the security settings you just see a code block</pre></div><div class=image-block><img src=/assets/asciidoc-plantuml/preview-nok.png alt="broken preview"></div><p>Hope this post helped you.
If you have any questions or know of better/alternative ways let me know via <a href=https://twitter.com/anoff_io>Twitter</a> or leave a comment 👋</p></section></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/docs>docs</a>
<a href=/tags/development>development</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-04-19-antora-plantuml-customize-ui/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-04-19-antora-plantuml-customize-ui/><img src=/assets/antora-puml/title.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-04-19-antora-plantuml-customize-ui/>Advanced customization for Antora - PlantUML support &amp; custom UI</a></h3><div class=meta><span class="date moment">2019-04-19</span>
<span class=readingTime>5 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>This post will cover some slightly advanced steps for building a multi-repository Asciidoc documentation using <a href=//antora.org/>Antora</a>.
My previous post <a href=//blog.anoff.io/2019-02-15-antora-first-steps/>blog.anoff.io/2019-02-15-antora-first-steps</a> covered basics of Antora and how to migrate existing AsciiDoc files.
In this post I will go through the steps of including content from another repository, building a custom UI and adding plantUML support to the (automated, dockerized) build.</p><section class="doc-section level-1"><h2 id=_plantuml_support>plantUML support</h2><p>One of the most important things for me when it comes to software docs is the ability to show relationships and interactions using diagrams.
As you might know from my <a href=/2018-07-31-diagrams-with-plantuml/>previous posts</a> I am a huge plantUML fan.
So plantUML support is important both for rendering the Antora website and the local development.</p></section><section class="doc-section level-1"><h2 id=_local_preview>Local preview</h2><p>For local previews I use the <a href="https://marketplace.visualstudio.com/items?itemName=joaompinto.asciidoctor-vscode">AsciiDoc extension</a> by João Pinto.</p><figure class=image-block><img src=/assets/antora-puml/vscode-asciidoc.png alt="VS Code Preview of PlantUML in .aodc"><figcaption>Figure 1. PlantUML preview in VS code</figcaption></figure><p>To get the plugin working you need to set the <code>plantuml-server-url</code> Asciidoctor attribute on your page as described on the <a href=https://github.com/eshepelyuk/asciidoctor-plantuml.js#configuration>asciidoctor-plantuml package</a> that is used for rendering in VSC.
Sadly this needs to be set for every single adoc file - if you want to preview it.</p><div class=listing-block><pre class=highlight><code class=language-asciidoc data-lang=asciidoc>:plantuml-server-url: http://plantuml.com/plantuml</code></pre></div></section><section class="doc-section level-1"><h2 id=_antora_plantuml_rendering>Antora plantUML rendering</h2><p>To enable plantUML in Antora you need to register the <a href=https://github.com/eshepelyuk/asciidoctor-plantuml.js#configuration>asciidoctor-plantuml package</a> and configure the same attribute as for local preview.
However in the case of Antora you an specify it one in the <code>playbook.yml</code>.</p><aside class="admonition-block note" role=note><h6 class="block-title label-only"><span class=title-label>Note:</span></h6><p>If you have a different server defined in the page itself, this will overrule the global config.</p></aside><figure class=listing-block><figcaption>playbook.yml</figcaption><pre class=highlight><code class=language-yaml data-lang=yaml>asciidoc:
  attributes:
    plantuml-server-url: http://www.plantuml.com/plantuml
  extensions:
  - asciidoctor-plantuml</code></pre></figure></section><section class="doc-section level-1"><h2 id=_multiple_repositories_for_a_single_documentation>Multiple repositories for a single documentation</h2><p>Another feature I promised to address during my <a href=/2019-02-15-antora-first-steps/>previous post</a> was splitting up content into multiple Antora modules/components.
For my <a href=https://github.com/anoff/antora-arc42>arc42 dummy project</a> I used both.</p><figure class=image-block><img src=/assets/antora-puml/arc-toc.png alt="ARC42 table of contents"><figcaption>Figure 2. Table of Contents for ARC42 project</figcaption></figure><p>Given the above table of contents the chapters <em>Cross-cutting concepts</em> and <em>Architecture decisions</em> where put into a separate module within the main component.
The modules <em>concepts</em> and <em>adr</em> (architecture design record) are moved into <a href=https://github.com/anoff/antora-arc42/tree/master/docs/modules>separate modules</a> because I prefer to have each concept/adr in a separate <code>.adoc</code> file.
For this example a simple subfolder within the <code>ROOT/pages</code> directory might suffice but in a real world scenario having a different module might come in handy to handle these important topics more efficiently.
Both concepts and ADRs are aggregated into a single <code>index.adoc</code> file in each module and are included in the main build.</p><p>A separate Antora component is used in this example for the <em>Media Manager</em> subsystem that makes up one of the level 1 building blocks.
Imagine this subsystem being developed in a separate repository.
In this case you want to keep the respective documentation within the <em>MediaManager</em> repository.
This is done in the <a href=https://github.com/anoff/antora-arc42-mediaman>antora-arc42-mediaman</a> repository where all the subsystems source code and documentation shall be kept.</p><p>In the example build the Level 2 definition of the <em>Media Manager</em> block diagram view is included from the remote repository of the subsystem.
You can see this include on <a href=https://github.com/anoff/antora-arc42/blame/master/docs/modules/ROOT/pages/05_building_block_view.adoc#L178>line 178 of the building_block_view.adoc</a>.</p><p>So overall the ARC42 build uses four modules spread across two components to build its entire documentation.
Some modules provide <a href=https://docs.antora.org/antora/2.0/asciidoc/include-partial/>Antora partials</a> whereas others provide entire pages that get referenced in the main ROOT module.</p><figure class=image-block><img src=/assets/antora-puml/antora-component-setup.svg alt="antora component setup" width=327 height=400><figcaption>Figure 3. Multi component, multi module Antora setup</figcaption></figure></section><section class="doc-section level-1"><h2 id=_customizing_the_antora_ui>Customizing the Antora UI</h2><p>For minor modifications of the UI you can use the <em>supplemental_files</em> attribute in the playbook.
Supplemental files allow you to exchange parts of the <strong>built</strong> UI bundle.
Given the current state of the default UI that you can find at <a href="https://gitlab.com/antora/antora-ui-default/-/jobs/artifacts/master/raw/build/ui-bundle.zip?job=bundle-stable">gitlab.com/antora/antora-ui-default</a> this is best used to modify the content of header, footer etc.</p><section class="doc-section level-2"><h3 id=_applying_minor_changes_via_supplement_files>Applying minor changes via supplement_files</h3><p>On <a href=https://github.com/anoff/antora-arc42/tree/34fb829cd4924d6fcc937e9cb72bdaeac73b8cf1/supplemental-ui>this commit</a> of the antora-arc42 you can see <em>supplementa_files</em> being defined and used.
To modify content from the UI bundle simply check it into the repository of your antora playbook and reference it</p><figure class=listing-block><figcaption>Specifying supplemental_files for the Antora UI bundle</figcaption><pre class=highlight><code class=language-yaml data-lang=yaml>ui:
  bundle:
    url: https://gitlab.com/antora/antora-ui-default/-/jobs/artifacts/master/raw/build/ui-bundle.zip?job=bundle-stable
    snapshot: true
supplemental_files: ./supplemental-ui</code></pre></figure><p>In the repository I applied a custom footer template to the bundle.</p><figure class=listing-block><figcaption>supplemental-ui/partials/footer-content.hbs</figcaption><pre class=highlight><code class=language-html data-lang=html>&lt;footer class="footer"&gt;
  &lt;p&gt;Original arc42 template licensed under &lt;a href="https://raw.githubusercontent.com/arc42/arc42-template/master/LICENSE.txt"&gt;MIT&lt;/a&gt; and modified for antora fit by &lt;a href="https://anoff.io"&gt;Andreas Offenhaeuser&lt;/a&gt;, the page is created using the Antora Default UI licensed under &lt;a href="https://gitlab.com/antora/antora-ui-default/blob/master/LICENSE"&gt;MPL-2.0&lt;/a&gt;&lt;/p&gt;
&lt;/footer&gt;</code></pre></figure><p>As all style attributes are bundled into a single <code>site.css</code> file it is quite hard to modify the UI style via this method.
Dan - the author of Antora - explained it like this in an <a href=https://gitlab.com/antora/antora/issues/149>issue discussion</a> I had in the Antora repository.</p><figure class=image-block><img src=/assets/antora-puml/ui-style.png alt="Dan Allen on customizing the UI"><figcaption>Figure 4. Dan Allen on customizing the UI</figcaption></figure></section><section class="doc-section level-2"><h3 id=_creating_a_custom_ui_bundle>Creating a custom UI bundle</h3><p>Not being able to modify the generated sites style via the <em>supplemental_files</em> method I set out to create a custom UI bundle for my ARC42 documentation.
The main changes I implemented with this bundle are:</p><div class="olist arabic"><ol class=arabic><li>custom color theme via <a href=https://github.com/anoff/antora-arc42-ui/commit/a678116e661bc1d1e06bf72559ff21a886a260dd>src/css/</a></li><li>customized header and footer files</li><li>add a <a href=https://github.com/anoff/antora-arc42-ui/commit/11fc95f7946046e203d6cf093715a3c37c35b6ce>custom CSS/JS</a> to provide help text that can be toggled via the <code>toggle help</code> text in the navigation bar</li><li>remove the component navigation dropdown as shown in the image below</li></ol></div><figure class=image-block><img src=/assets/antora-puml/navdrop.gif alt="component navigation dropdown"><figcaption>Figure 5. Antora component navigator</figcaption></figure><p>The component navigation has been removed because in the case of the ARC42 documentation the MediaManager component is not a documentation in itself but merely a way of creating a <em>multi-repository architecture documentation</em>.
Therefore only a single entrypoint into the documentation is required.
If your project has both - Antora components that merely serve as partial/page providers and components that serve as standalone documentation you may want to create a custom navigation option as well.</p></section></section><section class="doc-section level-1"><h2 id=_summary>Summary</h2><p>The Antora ARC42 build now consists of three repositories</p><div class="olist arabic"><ol class=arabic><li>the playbook and main ARC42 dos at <a class=bare href=https://github.com/anoff/antora-arc42>https://github.com/anoff/antora-arc42</a></li><li>an Antora component to provide lower level documentation of the <a href=https://github.com/anoff/antora-arc42-mediaman>antora-arc42-mediaman</a> to be included in the build</li><li>a custom UI bundle <a class=bare href=https://github.com/anoff/antora-arc42-ui>https://github.com/anoff/antora-arc42-ui</a></li></ol></div><p>These repositories should act as a good reference to create more advanced builds with Antora while not cluttering the individual repositories with too many features/changes.
As with most of my recent projects all automation is done via <a href=https://cloud.drone.io/anoff/antora-arc42>Drone CI</a>, see the respective <code>.drone.yml</code> repositories in the main repository and the UI bundle for reference.</p><figure class=image-block><img src=/assets/antora-puml/screenshot.png alt="Screenshot of the gitarc.xyz page"><figcaption>Figure 6. Screenshot of the final gitarc.xyz ARC42 Antora build</figcaption></figure><p>You can view the final result at <a href=http://gitarc.xyz/system/0.9.0/03_system_scope_and_context.html?help>gitarc.xyz</a> with <code>?help</code> showing all the original ARC42 help texts for each chapter.</p><p>If you have any questions or know of better/alternative ways let me know via Twitter, leave a comment or submit changes to this post directly via PR 👋</p></section></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/docs>docs</a>
<a href=/tags/architecture>architecture</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-04-08-cv-continuous-vitae/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-04-08-cv-continuous-vitae/><img src=/assets/continuous-cv/logo.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-04-08-cv-continuous-vitae/>Continuous Vitae - Auto built and git versioned CV</a></h3><div class=meta><span class="date moment">2019-04-08</span>
<span class=readingTime>6 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div>Versioning your CV is important. One traditional approach is to date it whenever you send it out. I chose to present my CV on my website and host it on GitHub. In this blog post I want to explain how I set up continuous integration pipeline for building my CV that automatically injects a unique version into each build. This method is applicable for anyone choosing to ascii-based CV - in my case LaTeX.
<a href=https://blog.anoff.io/2019-04-08-cv-continuous-vitae/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/recruiting>recruiting</a>
<a href=/tags/ci/cd>CI/CD</a>
<a href=/tags/drone>drone</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-03-24-self-hosted-gitea-drone/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-03-24-self-hosted-gitea-drone/><img src=/assets/gitea-drone/title.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-03-24-self-hosted-gitea-drone/>Hosting Gitea and Drone with Docker</a></h3><div class=meta><span class="date moment">2019-03-24</span>
<span class=readingTime>8 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>This post will walk you through setting up a self hosted git based continuous integration environment on a two machine setup - assuming you already have two virtual machines at your disposal.
Using <a href=https://gitea.io/><strong>Gitea</strong></a> for git hosting and contribution management and <a href=https://drone.io/><strong>Drone</strong></a> for docker-based build jobs, this will guide you through creating <strong>docker-compose</strong> files as well as configuring the individual services and getting <strong>SSL certificates</strong> via <a href=https://traefik.io/><strong>traefik</strong></a>.
Docker and docker-compose knowledge is required for this tutorial. It mostly focuses on the correct configuration of all the services at play here and not explaining their basic functionality.</p><p>This tutorial uses Azure resources so some of the aspects might not be 100% applicable if you chose another infrastructure provider.</p><p><a href=https://blog.anoff.io/2019-03-24-self-hosted-gitea-drone/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/azure>azure</a>
<a href=/tags/gitea>gitea</a>
<a href=/tags/drone>drone</a>
<a href=/tags/ci/cd>CI/CD</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-03-23-configure-azure-ad-for-gitea/><i class="fa fa-fw fa-pencil"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-03-23-configure-azure-ad-for-gitea/><img src=/assets/gitea-aad/title.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-03-23-configure-azure-ad-for-gitea/>Configure Azure Active Directory as Authentication Provider for Gitea</a></h3><div class=meta><span class="date moment">2019-03-23</span>
<span class=readingTime>3 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p><a href=https://gitea.io/en-us/>Gitea</a> is an open source git hosting platform, written in Go forked from the Gogs project and seems to be highly inspired by GitHub.
If you want to host your own git platform and want to use <strong>Azure Active Directory</strong> as an authentication provider - this post might help you.</p><p><a href=https://blog.anoff.io/2019-03-23-configure-azure-ad-for-gitea/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/gitea>gitea</a>
<a href=/tags/azure>azure</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-02-17-hugo-render-asciidoc/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-02-17-hugo-render-asciidoc/><img src=/assets/hugo-asciidoc/vladimir-kramer-145-unsplash.jpg alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-02-17-hugo-render-asciidoc/>Get Hugo to render (nice) Asciidocs</a></h3><div class=meta><span class="date moment">2019-02-17</span>
<span class=readingTime>5 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div>While migrating my blog from Jekyll to Hugo I went down quite a rabbit hole. While setup and migration to Hugo was a breeze, I spent a lot of time making my .adoc formatted post work with the new blog. After working through several GitHub issues I ended up manipulating the DOM with Javascript to get admonitions working. It still doesn&#8217;t feel right - but hey it works! 🤷‍♂️ This post will cover the steps I took in case I myself or anyone out there ever needs to do this again.
<a href=https://blog.anoff.io/2019-02-17-hugo-render-asciidoc/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/development>development</a>
<a href=/tags/docs>docs</a>
<a href=/tags/web>web</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-02-15-antora-first-steps/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-02-15-antora-first-steps/><img src=/assets/antora-arc42/antora-arc42.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-02-15-antora-first-steps/>Converting existing AsciiDoc into an Antora project</a></h3><div class=meta><span class="date moment">2019-02-15</span>
<span class=readingTime>7 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div>After 2 years of working with the arc42 template in markdown, I spent the last few weeks learning about an asciidoc based site generator named Antora. The main reason for the interest in AsciiDoc was the fact that the limited feature set in markdown often impairs you while writing down complex things. But I had one problem; most of our documentation is scattered across multiple repositories as we try to keep the docs as close to the code as possible.
<a href=https://blog.anoff.io/2019-02-15-antora-first-steps/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/development>development</a>
<a href=/tags/docs>docs</a>
<a href=/tags/architecture>architecture</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-01-31-book-google-schmidt/><i class="fa fa-fw fa-book"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-01-31-book-google-schmidt/><img src=/assets/book-google/cover.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-01-31-book-google-schmidt/>What I learned about Management and Recruiting</a></h3><div class=meta><span class="date moment">2019-01-31</span>
<span class=readingTime>7 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>As <a href="{{ site.baseurl }}/2019-01-15-book-2018-in-books">promised</a> my book series will start with two books out of the <a href=https://en.wikipedia.org/wiki/Facebook,_Apple,_Amazon,_Netflix_and_Google>FAANG</a> league. The book <em>How Google works</em> covers many aspects of the companies culture. The book has lots of management insights that - at the time of reading - were of little interest to me. Therefore I want to briefly highlight a few points about <a href=#innovation>innovation</a> that I find fascinating and then move to the human factors like <a href=#recruiting>recruiting</a> and <a href=#competence-management>competence management</a> that are also covered extensively in the book.</p><a href=https://blog.anoff.io/2019-01-31-book-google-schmidt/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/books>books</a>
<a href=/tags/recruiting>recruiting</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2019-01-15-book-2018-in-books/><i class="fa fa-fw fa-book"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2019-01-15-book-2018-in-books/><img src=/assets/book-2018/feature.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2019-01-15-book-2018-in-books/>My year 2018 in books</a></h3><div class=meta><span class="date moment">2019-01-15</span>
<span class=readingTime>8 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div>For the last ~15 months I spent a lot of wasted time (commuting to work, waiting at the doctors, sitting on planes) with audio books. I have never been a big reader and the entry barrier to start listening to a book instead of music is a lot lower than packing books, reading instead of listening etc. That&rsquo;s why I became a really big fan of listening to various audiobooks.
<a href=https://blog.anoff.io/2019-01-15-book-2018-in-books/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/books>books</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2018-12-09-stuttgart-hackathon/><i class="fa fa-fw fa-pencil"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2018-12-09-stuttgart-hackathon/><img src=/assets/hackathons/stuttgart2018.jpg alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2018-12-09-stuttgart-hackathon/>Get the most out of hackathons</a></h3><div class=meta><span class="date moment">2018-12-09</span>
<span class=readingTime>4 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>End of October I joined the <a href=https://www.hackathon-stuttgart.de/>Stuttgart Hackathon</a> for the second time. It was my overall 4th public Hackathon. In this blog post I want to tell you why I enjoy doing Hackathons and why you should join one too if you have the chance!</p><blockquote><p>TL;DR; <strong>Network</strong> and play with expensive toys</p></blockquote><a href=https://blog.anoff.io/2018-12-09-stuttgart-hackathon/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/development>development</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2018-08-12-rbac-firestore/><i class="fa fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2018-08-12-rbac-firestore/><img src=/assets/rbac-firestore/feature.png alt></a></div><div class=content><h3><a href=https://blog.anoff.io/2018-08-12-rbac-firestore/>RBAC with Google Firestore</a></h3><div class=meta><span class="date moment">2018-08-12</span>
<span class=readingTime>7 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div><p>This post will explain how to implement role based access control (<a href=https://en.wikipedia.org/wiki/Role-based_access_control>RBAC</a>) using the Google Firestore serverless database. Firebase and Firestore in particular with the concept presented in this post offers the most seamless integration of serverless infrastructure with a mobile client at this point. It has become my go to backend for all minor web apps I build.</p><a href=https://blog.anoff.io/2018-08-12-rbac-firestore/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/google>google</a>
<a href=/tags/serverless>serverless</a>
<a href=/tags/web>web</a></div></div></div></article></div><div class="article-wrapper u-cf"><a class=bubble href=https://blog.anoff.io/2018-07-31-diagrams-with-plantuml/><i class="fa fa-fw fa-pencil"></i></a><article class="default article"><div class=content><h3><a href=https://blog.anoff.io/2018-07-31-diagrams-with-plantuml/>Markdown native diagrams with PlantUML</a></h3><div class=meta><span class="date moment">2018-07-31</span>
<span class=readingTime>9 min read</span>
<span class=author><a href=/author/anoff>anoff</a></span></div>This post covers PlantUML basics and how it can be used in GitLab or GitHub projects as well as a seamless local development environment using Visual Studio Code. I have been wanting to write this post for months. Lately I have been using PlantUML extensively at work but also in my private projects. You can see it being used in my plantbuddy and techradar projects on GitHub. Using it in different places and for various purposes I came across a bunch of issues that I want to share in this post.
<a href=https://blog.anoff.io/2018-07-31-diagrams-with-plantuml/ class=more>Continue reading</a></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/development>development</a>
<a href=/tags/gitlab>gitlab</a>
<a href=/tags/github>github</a>
<a href=/tags/docs>docs</a></div></div></div></article></div><div class=paginator><a href=/author/anoff/page/2/ class=older><i class="fa fa-angle-double-left"></i>Older posts</a></div></div><footer><div class=container><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=//twitter.com/anoff_io target=_blank><i class="fa fa-twitter-adblock-proof"></i></a><a href=//github.com/anoff target=_blank><i class="fa fa-github"></i></a><a href=//linkedin.com/in/offenhaeuser/ target=_blank><i class="fa fa-linkedin"></i></a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=//anoff.io target=_blank>&copy;
2019
by Andreas Offenhaeuser</a>
-
<a href=https://blog.anoff.io/author/anoff/index.xml>RSS</a></div><div class=author><a href=//github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-93890295-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src=/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script><script type=text/javascript src=/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script><script>$(".moment").each(function(){$(this).text(moment($(this).text()).locale("en").format('LL'));});$(".footnote-return sup").html("");</script><script src=https://blog.anoff.io/fix-adoc.js type=application/javascript></script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js type=application/javascript></script><script src=https://blog.anoff.io/init-cookieconsent.js type=application/javascript></script></body></html>