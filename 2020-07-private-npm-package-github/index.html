<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Andreas Offenhaeuser"><meta name=description content="Andreas' personal blog"><meta name=keywords content=blog,personal,software,architecture,node,markdown,plantuml,developer><meta name=generator content="Hugo 0.55.6"><title>Publishing private npm packages to GitHub Package registry for free &vert; Andreas&#39; Blog</title><meta name=description content="Publishing private npm packages to GitHub Package registry for free - Andreas' personal blog"><meta itemprop=name content="Publishing private npm packages to GitHub Package registry for free"><meta itemprop=description content="Publishing private npm packages to GitHub Package registry for free - Andreas' personal blog"><meta property=og:title content="Publishing private npm packages to GitHub Package registry for free"><meta property=og:description content="Publishing private npm packages to GitHub Package registry for free - Andreas' personal blog"><meta property=og:image content=https://blog.anoff.io/assets/github-npm/title.png><meta property=og:url content=https://blog.anoff.io/2020-07-private-npm-package-github/><meta property=og:site_name content="Andreas' Blog"><meta property=og:type content=article><link href=/2020-07-private-npm-package-github/ rel=alternate type=application/rss+xml title="Andreas' Blog"><link href=/2020-07-private-npm-package-github/ rel=feed type=application/rss+xml title="Andreas' Blog"><link rel=stylesheet href=https://blog.anoff.io/theme.css><link rel=stylesheet href=https://blog.anoff.io/adoc.css><link rel=stylesheet href=https://blog.anoff.io/overwrites.css><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css></head><body class=bilberry-hugo-theme><nav class=permanentTopNav><div class=container><ul class=topnav><li><a href=//anoff.io/ target=_self>About me</a></li><li><a href=/ target=_self>Blog</a></li><li><a href=//anoff.io/project/ target=_self>Projects</a></li><li><a href=/tags target=_self>by Tags</a></li><li><a href=//radar.anoff.io target=_blank>Tech skills</a></li><li><a href=//anoff.github.io/legal/ target=_blank>Legal</a></li></ul></div></nav><header><div class=container><div class=logo><a id=siteBaseUrl href=/ class=logo><img src=/avatar.png alt>
<span class=overlay><i class="fa fa-child"></i></span></a></div><div class=titles><h3 class=title><a href=/>Andreas&#39; Blog</a></h3><span class=subtitle>Adventures of a software engineer/architect</span></div><div class="toggler permanentTopNav"><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://blog.anoff.io/2020-07-private-npm-package-github/><i class="fas fa-fw fa-code"></i></a><article class="default article"><div class=featured-image><a href=https://blog.anoff.io/2020-07-private-npm-package-github/><img src=/assets/github-npm/title.png alt></a></div><div class=content><h1 class=article-title><a href=https://blog.anoff.io/2020-07-private-npm-package-github/>Publishing private npm packages to GitHub Package registry for free</a></h1><div class=meta><span class="date moment">2020-07-26</span>
<span class=readingTime>4 min read</span>
<span class=author><a href=https://blog.anoff.io/author/anoff/>anoff</a></span></div><p>Even though I am a big fan of Open Source Software and try to make my projects open and consumable by others as well, there are cases where you want to keep your stuff private.
But even if you work in a closed source environment you still want to use the same tools that you employ in the open source world.
In this blog post I will explain how you can create private npm packages for your Javascript/Typescript projects - and I will show you how you can host your private npm packages <strong>for free</strong>!</p><ul><li><a href=#introduction-to-github-packages>Introduction to GitHub Packages</a><ul><li><a href=#pricing->Pricing ðŸ’°</a></li></ul></li><li><a href=#using-github-packages>Using GitHub Packages</a></li><li><a href=#publishing-private-packages>Publishing private packages</a></li><li><a href=#consuming-private-packages-in-github-actions>Consuming private packages in GitHub Actions</a></li></ul><h2 id=introduction-to-github-packages>Introduction to GitHub Packages</h2><p>A few months ago GitHub made their <a href=https://github.com/features/packages>package registry</a> globally available to every user.
It offers not only a registry for npm packages but also supports many other tools and programming languages like Docker, Maven, NuGet, RubyGems.
You can use GitHub packages with the same tools you are used to - npm, yarn and a <code>package.json</code> for specifying your package dependencies.</p><h3 id=pricing>Pricing ðŸ’°</h3><p>One advantage of GitHub Packages is that it allows you to publish private packages <strong>for free</strong>.
If you want to publish private packages on npmjs you need to pay at least $7 / month.
GitHub Packages has a fair use policy where you can create public and private packages for free for the first 500MB of package data an and 1GB traffic per month.</p><h2 id=using-github-packages>Using GitHub Packages</h2><p>By default your local tools will access the npmjs registry located at <a href=https://registry.npmjs.org/>https://registry.npmjs.org/</a>.
That means all requests to install or publish packages will be sent there.</p><p><img src=/assets/github-npm/npm-default.png alt="npm uses npmjs registry by default"></p><p>To use GitHub Packages you need to configure your npm (or yarn) to use the GitHub Packages URL.
The npm registry for GitHub Packages is <a href=https://npm.pkg.github.com>https://npm.pkg.github.com</a>.
For packages that are not available on GitHub Packages the service will automatically proxy all requests to the npmjs registry.
This might make the installation a little bit slower but it means you don&rsquo;t have to decide between GitHub Packages OR npmjs.</p><p><img src=/assets/github-npm/npm-github.png alt="use GitHub Packages registry"></p><p>GitHub Packages <strong>requires user authentication</strong> not only for publishing but also for installing packages.
This is different from the npmjs registry that allows anonymous read access.</p><p>So you first need to provide <code>npm</code> with an authentication token.
To do this you need to modify your local <a href=https://docs.npmjs.com/configuring-npm/npmrc.html>npm configuration</a> that is located in the <code>.npmrc</code> file.
If you want to change the behavior only for a single project the file should be located in the project directory <code>/path/to/project/.npmrc</code>.
Once you decide you want to use GitHub Packages as default for all your projects it makes sense to modify your user configuration located in the home directory <code>~/.npmrc</code>.</p><p>The <code>.npmrc</code> file needs to contain the following line to use GitHub Packages:</p><pre><code class=language-sh>//npm.pkg.github.com/:_authToken=&lt;PERSONAL ACCESS TOKEN WITH read:packages SCOPE&gt;
</code></pre><p>The Personal Access Token can be generated in the <a href=https://github.com/settings/tokens>GitHub Developer Settings</a></p><p><img src=/assets/github-npm/ss-tokens.png alt="GitHub PAT overview"></p><p><img src=/assets/github-npm/ss-token-gen.png alt="GitHub PAT Creation"></p><p>Make sure to give at least the <code>read:packages</code> scope, and also the <code>write:packages</code> and <code>delete:packages</code> if you plan on publishing packages as well.</p><h2 id=publishing-private-packages>Publishing private packages</h2><p>Any package that is published from a private repo also becomes a private package.
This is currently the only way to define the visibility of the package but I also think it makes sense to couple this.
So what you need to do is make sure the repository where you publish this package from is set to private.</p><p><img src=/assets/github-npm/public-private.png alt="Private repo creates a private package"></p><p>As a final step you need to configure your package configuration to also publish to GitHub Packages.</p><p>You do this by adding the following entry to your package definition</p><pre><code class=language-javascript>  &quot;publishConfig&quot;: {
    &quot;registry&quot;: &quot;https://npm.pkg.github.com/&quot;
  },
</code></pre><p>You also need to make sure your npm package is scoped to your organization or username, you do this by adding <code>@SCOPE/</code> to your package name</p><pre><code class=language-javascript>  &quot;name&quot;: &quot;@anoff/my-private-package&quot;,
</code></pre><h2 id=consuming-private-packages-in-github-actions>Consuming private packages in GitHub Actions</h2><p>If you want to consume private packages hosted on GitHub Packages you need to provide an authentication token as you also did for your local environment.
I highly recommend to create a separate token for use in any CI environment.
In the GitHub Actions workflow you can add the authentication by adding this step, the secret <code>PACKAGE_TOKEN</code> needs to be added manually by you and should have the <code>read:packages</code> scope.</p><pre><code class=language-yaml>- run: echo &quot;//npm.pkg.github.com/:_authToken=${{ secrets.PACKAGE_TOKEN }}&quot; &gt;&gt; .npmrc
  name: add auth token for npm packages
</code></pre><p>I hope this post helped you out and I would love to hear your thoughts in the comments or via <a href=https://twitter.com/anoff_io>Twitter</a> ðŸ‘‹</p></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=https://blog.anoff.io/tags/web/>web</a>
<a href=https://blog.anoff.io/tags/development/>development</a>
<a href=https://blog.anoff.io/tags/github/>github</a></div></div></div></article></div><div id=comments-container><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"anoff-io"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><footer><div class=container><div class=right><div class=external-profiles><strong>Social media</strong></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=//anoff.io target=_blank>&copy;
2022
by Andreas Offenhaeuser</a></div><div class=author><a href=//github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-93890295-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript src=https://blog.anoff.io/theme.js></script><script src=https://blog.anoff.io/fix-adoc.js type=application/javascript></script><script src=//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js type=application/javascript></script><script src=https://blog.anoff.io/init-cookieconsent.js type=application/javascript></script></body></html>